#coreseek
source wzhouhui
{
        type                    = mysql
        sql_host                =  192.168.6.71
        sql_user                = root
        sql_pass                = admin123
		sql_query_pre           = SET NAMES utf8
        sql_db                  = wzhouhui_db
        sql_port                = 3306  # optional, default is 3306

sql_query                               = \
select g.goods_id,g.is_delete,g.is_on_sale, g.goods_sn,ge.available_stock,ge.avg_rate as avg_rate,is_24h_ship,g.goods_title, g.goods_name, g.goods_brief, g.add_time, g.sort_order, g.group_goods_id, g.point_rate,g.promote_price,g.promote_start_date, g.promote_end_date, g.goods_thumb , g.goods_img,g.goods_grid ,g.url_title,g.goods_type,g.goods_weight,date_format(from_unixtime(`g`.`add_time`),'%Y%m%d') AS `add_date`,  ge.review_count AS reviews, g.brand, g.source,g.goods_tag,g.maidian, \
                       g.is_free_shipping, g.is_hot,g.is_new, g.is_promote, g.week2sale, g.click_count, g.shop_price, g.is_login, g.cat_id, (if(goods_number=0,0,1)) as goods_number,g.market_price ,\
if (is_new_sn,left(goods_sn,7),goods_sn) as group_goods_sn, \
                      count(DISTINCT rid) AS review_count,sum(rate_overall) as review_rate, g.goods_search_attr AS goods_attr, \
                       CONCAT(IF(g.promote_start_date<UNIX_TIMESTAMP() AND g.promote_end_date>UNIX_TIMESTAMP(), 2, 1), EXISTS(SELECT goods_id FROM eload_goods_tuijian WHERE goods_id=g.goods_id AND (is_best=1 OR is_new=1 OR is_hot=1))) AS hot_order, ge.shelf_down_type, ge.clearance_discount, ge.clearance_date, \
EXISTS(SELECT goods_id FROM eload_goods_extend WHERE goods_id=g.goods_id AND (is_24h_ship=1 OR goods_grade=1)) AS is_24_grade, ge.recommendation \
                FROM eload_goods as g \
                LEFT JOIN eload_review as r ON r.goods_id = g.goods_id \
                LEFT JOIN eload_goods_attr as ga ON g.goods_id = ga.goods_id \
                LEFT JOIN eload_goods_extend as ge ON g.goods_id = ge.goods_id \
                WHERE g.is_on_sale=1 AND g.is_delete=0 AND g.is_alone_sale = 1  GROUP BY g.goods_id

	sql_field_string     = goods_title
	sql_field_string     = goods_name
	sql_field_string     = goods_brief
	sql_field_string     = goods_sn
	sql_field_string     = goods_tag
	sql_field_string     = maidian
	sql_attr_uint	     = available_stock
	sql_attr_string      = goods_thumb
	sql_attr_string      = goods_img
	sql_attr_string      = goods_grid
	sql_attr_string      = url_title
	sql_attr_uint        = add_date
	sql_attr_string      = group_goods_sn
	sql_attr_uint	     = is_delete
	sql_attr_uint        = is_on_sale
	sql_attr_float       = promote_price

	sql_attr_uint        = promote_start_date
	sql_attr_uint        = promote_end_date

	sql_attr_uint        = goods_type
	sql_attr_uint	     = is_24h_ship

	sql_attr_timestamp   = add_time
	sql_attr_uint        = sort_order
	sql_attr_uint        = goods_number
	sql_attr_uint        = group_goods_id
	sql_attr_float       = point_rate
	sql_attr_uint        = is_free_shipping
	sql_attr_uint        = is_hot
	sql_attr_uint        = review_count
	sql_attr_uint        = week2sale
	sql_attr_uint        = click_count
	sql_attr_uint        = review_rate
	sql_attr_uint        = reviews
	sql_attr_float       = shop_price
	sql_attr_float       = market_price
	sql_attr_uint        = is_24_grade
	sql_attr_float       = goods_weight
	sql_attr_uint	     = shelf_down_type
	sql_attr_uint	     = clearance_discount
	sql_attr_uint	     = clearance_date

	sql_attr_uint        = is_login
	sql_attr_uint        = cat_id
	sql_attr_uint        = is_new
	sql_attr_uint        = is_promote
	sql_attr_uint        = hot_order
	sql_attr_uint        = avg_rate
	sql_attr_float	     = recommendation
	sql_field_string     = brand
	sql_attr_uint        = source
	sql_attr_multi       = uint cat_id_all from query; SELECT goods_id,cat_id FROM (SELECT goods_id,cat_id FROM eload_goods UNION SELECT goods_id,cat_id FROM eload_goods_cat) AS t
}

source wzhouhui_sphinx_keywords{
	type                    = mysql
    sql_host                = 192.168.6.71
    sql_user                = root
    sql_pass                = admin123
    sql_db                  = wzhouhui_db
    sql_query_pre           = SET NAMES utf8
	sql_query				=SELECT id,keyword as sphinx_keyword,add_time,click_count,keysort,is_default,goods_count FROM eload_sphinx_keywords

	sql_field_string		= sphinx_keyword
	sql_attr_uint			= add_time
	sql_attr_uint			= click_count
	sql_attr_uint			= keysort
	sql_attr_uint			= is_default
	sql_attr_uint			= goods_count
	
}


index wzhouhui {
    source                  = wzhouhui
    path                    = /usr/local/coreseek/var/data/wzhouhui
    docinfo                 = extern
    #enable_star            = 1
    #infix_fields           = goods_sn,goods_brief,goods_title,keywords,color_size,goods_tag
    #min_infix_len          = 1
    #ngram_len		        =0
    #charset_table		    = 0..9,A..Z->a..z,a..z,U+2C,U+2E,U+2B,U+5F,U+7B,U+7D,U+5E,U+43,U+26,U+28,U+29,U+2F,U+2D
    charset_dictpath		= /usr/local/mmseg3/etc/
	charset_type  			= zh_cn.utf-8


}

index wzhouhui_sphinx_keywords{
    source                  = wzhouhui_sphinx_keywords
    path                    = /usr/local/sphinx/var/data/wzhouhui_sphinx_keywords
	min_infix_len 			= 1	
	charset_type  = utf-8
	ngram_len = 1
	ngram_chars 			= U+4E00..U+9FBF, U+3400..U+4DBF, U+20000..U+2A6DF, U+F900..U+FAFF,\
						U+2F800..U+2FA1F, U+2E80..U+2EFF, U+2F00..U+2FDF, U+3100..U+312F, U+31A0..U+31BF,\
						U+3040..U+309F, U+30A0..U+30FF, U+31F0..U+31FF, U+AC00..U+D7AF, U+1100..U+11FF,\
						U+3130..U+318F, U+A000..U+A48F, U+A490..U+A4CF	

	charset_table 			= U+FF10..U+FF19->0..9, 0..9, U+FF41..U+FF5A->a..z, U+FF21..U+FF3A->a..z,\
						A..Z->a..z, a..z, U+0149, U+017F, U+0138, U+00DF, U+00FF, U+00C0..U+00D6->U+00E0..U+00F6,\
						U+00E0..U+00F6, U+00D8..U+00DE->U+00F8..U+00FE, U+00F8..U+00FE, U+0100->U+0101, U+0101,\
						U+0102->U+0103, U+0103, U+0104->U+0105, U+0105, U+0106->U+0107, U+0107, U+0108->U+0109,\
						U+0109, U+010A->U+010B, U+010B, U+010C->U+010D, U+010D, U+010E->U+010F, U+010F,\
						U+0110->U+0111, U+0111, U+0112->U+0113, U+0113, U+0114->U+0115, U+0115, \
						U+0116->U+0117,U+0117, U+0118->U+0119, U+0119, U+011A->U+011B, U+011B, U+011C->U+011D,\
						U+011D,U+011E->U+011F, U+011F, U+0130->U+0131, U+0131, U+0132->U+0133, U+0133, \
						U+0134->U+0135,U+0135, U+0136->U+0137, U+0137, U+0139->U+013A, U+013A, U+013B->U+013C, \
						U+013C,U+013D->U+013E, U+013E, U+013F->U+0140, U+0140, U+0141->U+0142, U+0142, \
						U+0143->U+0144,U+0144, U+0145->U+0146, U+0146, U+0147->U+0148, U+0148, U+014A->U+014B, \
						U+014B,U+014C->U+014D, U+014D, U+014E->U+014F, U+014F, U+0150->U+0151, U+0151, \
						U+0152->U+0153,U+0153, U+0154->U+0155, U+0155, U+0156->U+0157, U+0157, U+0158->U+0159,\
						U+0159,U+015A->U+015B, U+015B, U+015C->U+015D, U+015D, U+015E->U+015F, U+015F, \
						U+0160->U+0161,U+0161, U+0162->U+0163, U+0163, U+0164->U+0165, U+0165, U+0166->U+0167, \
						U+0167,U+0168->U+0169, U+0169, U+016A->U+016B, U+016B, U+016C->U+016D, U+016D, \
						U+016E->U+016F,U+016F, U+0170->U+0171, U+0171, U+0172->U+0173, U+0173, U+0174->U+0175,\
						U+0175,U+0176->U+0177, U+0177, U+0178->U+00FF, U+00FF, U+0179->U+017A, U+017A, \
						U+017B->U+017C,U+017C, U+017D->U+017E, U+017E, U+0410..U+042F->U+0430..U+044F, \
						U+0430..U+044F,U+05D0..U+05EA, U+0531..U+0556->U+0561..U+0586, U+0561..U+0587, \
						U+0621..U+063A, U+01B9,U+01BF, U+0640..U+064A, U+0660..U+0669, U+066E, U+066F, \
						U+0671..U+06D3, U+06F0..U+06FF,U+0904..U+0939, U+0958..U+095F, U+0960..U+0963, \
						U+0966..U+096F, U+097B..U+097F,U+0985..U+09B9, U+09CE, U+09DC..U+09E3, U+09E6..U+09EF, \
						U+0A05..U+0A39, U+0A59..U+0A5E,U+0A66..U+0A6F, U+0A85..U+0AB9, U+0AE0..U+0AE3, \
						U+0AE6..U+0AEF, U+0B05..U+0B39,U+0B5C..U+0B61, U+0B66..U+0B6F, U+0B71, U+0B85..U+0BB9, \
						U+0BE6..U+0BF2, U+0C05..U+0C39,U+0C66..U+0C6F, U+0C85..U+0CB9, U+0CDE..U+0CE3, \
						U+0CE6..U+0CEF, U+0D05..U+0D39, U+0D60,U+0D61, U+0D66..U+0D6F, U+0D85..U+0DC6, \
						U+1900..U+1938, U+1946..U+194F, U+A800..U+A805,U+A807..U+A822, U+0386->U+03B1, \
						U+03AC->U+03B1, U+0388->U+03B5, U+03AD->U+03B5,U+0389->U+03B7, U+03AE->U+03B7, \
						U+038A->U+03B9, U+0390->U+03B9, U+03AA->U+03B9,U+03AF->U+03B9, U+03CA->U+03B9, \
						U+038C->U+03BF, U+03CC->U+03BF, U+038E->U+03C5,U+03AB->U+03C5, U+03B0->U+03C5, \
						U+03CB->U+03C5, U+03CD->U+03C5, U+038F->U+03C9,U+03CE->U+03C9, U+03C2->U+03C3, \
						U+0391..U+03A1->U+03B1..U+03C1,U+03A3..U+03A9->U+03C3..U+03C9, U+03B1..U+03C1, \
						U+03C3..U+03C9, U+0E01..U+0E2E,U+0E30..U+0E3A, U+0E40..U+0E45, U+0E47, U+0E50..U+0E59, \
						U+A000..U+A48F, U+4E00..U+9FBF,U+3400..U+4DBF, U+20000..U+2A6DF, U+F900..U+FAFF, \
						U+2F800..U+2FA1F, U+2E80..U+2EFF,U+2F00..U+2FDF, U+3100..U+312F, U+31A0..U+31BF, \
						U+3040..U+309F, U+30A0..U+30FF,U+31F0..U+31FF, U+AC00..U+D7AF, U+1100..U+11FF, \
						U+3130..U+318F, U+A000..U+A48F,U+A490..U+A4CF 
}


indexer {
        mem_limit           = 512M
}


searchd {
    listen                  = 9324
    log                     = /usr/local/coreseek/var/log/wzhouhui_searchd.log
    query_log               = /usr/local/coreseek/var/log/wzhouhui_query.log
    pid_file                = /usr/local/coreseek/var/log/wzhouhui_searchd.pid
    read_timeout            = 5
    max_children            = 30
    max_matches             = 10000
    seamless_rotate         = 1
    preopen_indexes         = 0
    unlink_old              = 1
    binlog_path             =
    compat_sphinxql_magics  = 0
}
